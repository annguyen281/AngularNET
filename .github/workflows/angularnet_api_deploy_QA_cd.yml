name: angularnet_api_deploy_QA_cd

on:
  workflow_dispatch:
    inputs:
      runner_number:
        type: string
        required: true
        name: 'Runner number of AngularNET DEV cicd'

jobs:
  deployment:
    name: "QA"
    runs-on: [self-hosted, nzox1]
    steps:
    - name: Download artifact
      uses: dawidd6/action-download-artifact@v2.21.1
      with:
        workflow: angularnet_api_cicd.yml
        repo: annguyen281/AngularNET
        run_number: ${{ github.event.inputs.runner_id }}
        name: package
        path: ${{ github.workspace }}
    - name: IIS Web App Deploy
      # You may pin to the exact commit or the version.
      # uses: cschleiden/webdeploy-action@48a2cdaf8aaa2bc762c12948ada3db14faead320
      uses: cschleiden/webdeploy-action@v1
      with:
        # Name of an existing website on the IIS machine
        webSiteName: angularnet_api
        # File path to the package or a folder generated by MSBuild or a compressed archive file.
        package: '**/*.zip'
        removeAdditionalFilesFlag: true
        takeAppOfflineFlag: true